\subsection{Quality control prior to variant calling}
In order to ensure the quality of the large quantity of BAMs produced for the project, an automatic quality control system will be employed to reduce the number of data files that required manual intervention. This system has been derived from the one originally designed for the UK10K project (http://www.uk10k.org) and uses a series of empirically derived thresholds to assess summary metrics calculated from the input BAMs. These thresholds included: percentage of reads mapped; percentage of duplicate reads marked; various statistics measuring indel distribution against read cycle and an insert size overlap percentage. Any lanes that fall below the "fail" threshold for any of the metrics are excluded; any lanes that fall below the "warn" threshold on a metric are manually examined; and any lane that does not fall below either of these thresholds for any of the metrics is given a status of "pass" and allowed to proceed into the later stages of the pipeline.

\subsection{Further preprocessing of reads}
Passed lanelets are then merged into BAMs corresponding to sample libraries with Picard MergeSamFiles and duplicates are marked again with Picard MarkDuplicates after which they are then merged into BAMs for each sample.  Finally sample level bam improvement will be carried out using GATK and samtools. This consists of re-alignment of reads around known and discovered indels using GATK RealignerTargetCreator and IndelRealigner followed by base quality score recalibration (BQSR) using GATK BaseRecalibrator and PrintReads. Lastly samtools calmd will be applied and indexes created. Known indels for realignment will be taken from the Mills Devine and 1000G Gold set and the 1000G phase 1 low coverage set. Known variants for BQSR will be taken from dbSNP 137.

Prior to variant calling we check for contamination (excess heterozygosity) and sample mix up (--best) with VerifyBamID and require that the calculated FREEMIX is less than 0.05. We only check for sample mix (--best) for each sample when SNP array genotypes are available for that sample. To quantify the contamination more accurately for all samples we use the expected population allele frequency when available. We run with default settings and recommended options; i.e. --genoError 1.0e-03 --minAF 0.01 --minCallRate 0.50 --minMapQ 10 --maxDepth 20 --minQ 13 --maxQ 40 --grid 0.05 --refRef 1.00 --refHet 0.50 --refAlt 0.00 --ignoreRG. Because verifyBamID assumes the VCF to be well-formed (e.g. whether the REF allele actually matches with the reference sequence) we don't use PLINK to convert our SNP array data from bed to vcf, because PLINK saves the major allele A2 as the reference in all cases. Instead we use our own script, which uses the reference sequence as input in addition to the bed file. FREEMIX will otherwise be overestimated.
%Prior to variant calling we check the gender of the samples with GATK3.3+ DepthOfCoverage and require that the ratio between the non-PAR X and Y coverage is less than 2 and greater than 5 for males and females, respectively.